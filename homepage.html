<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/homepage.css">
    <link rel="stylesheet" href="assets/css/root.css">
    <link rel="stylesheet" href="assets/fontawesome-free-6.0.0-beta2-web/css/all.min.css">
    <title>Valture - Homepage</title>
</head>
<style>
    nav.main-nav {
        position: absolute;
        background: transparent;
    }
    
    nav.main-nav .logo {
        color: var(--link-lightcolor);
    }
    
    nav.main-nav ul li a {
        color: var(--link-lightcolor);
    }
    
    nav.main-nav ul li:hover>ul {
        background: var(--transparentnav-darkcolor);
    }
    
    @media screen and (max-width: 885px) {
        nav.main-nav {
            position: relative;
            background: var(--transparentnav-lightcolor);
        }
        nav.main-nav .icon {
            color: var(--link-color);
        }
        nav.main-nav .logo {
            color: var(--link-color);
        }
        nav.main-nav ul li a {
            color: var(--link-color);
        }
        nav.main-nav ul li:hover>ul {
            background: var(--transparentnav-lightcolor);
        }
        nav.main-nav ul li i {
            font-size: 20px;
            padding: 0 3px;
        }
    }
</style>
<!--Start of Header-->

<body>
    <header class="homepage_header">
        <div class="carousel">
            <div class="carousel__item carousel__item--visible">
                <img src="assets/images/2.jpg" />
                <div>
                    <span>SEARCH FOR THE BOOK</span>
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Vero sit suscipit perferendis ipsa deserunt debitis quae nulla odit reiciendis vel, voluptas delectus impedit enim dolorum possimus id voluptatibus. Obcaecati, modi.
                    </p>
                    <a href="#">
                        View Collections
                    </a>
                </div>
            </div>
        </div>
    </header>
    <!--End of Header-->

    <!--Start of Upcoming Events-->
    <section class="upcoming_events">
        <div class="section-wrapper">
            <div class="section-title">
                <h2>upcoming events</h2>
            </div>
            <div class="carousel-slider">
                <div class="container">
                    <button class="handle left-handle">
                        <i class="fa-solid fa-angle-left"></i>
                    </button>
                    <div class="slider">
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>
                        <button type="button">
                            <span>January 21, 2022<br>Reading Icon</span>
                        </button>

                    </div>
                    <button class="handle right-handle">
                        <i class="fa-solid fa-angle-right"></i>
                    </button>
                </div>
                <div class="header">
                    <div class="progress-bar"></div>
                </div>
            </div>

            <div class="article-shortview">
                <div class="container img-container">
                    <img src="assets/images/1.jpg" alt="">
                </div>
                <div class="container intro-container">
                    <span>
                        <i class="fa-solid fa-calendar-days"></i>
                        January 2021, 2022 - Friday 9:00am-2:00pm
                    </span>
                    <h3>READING ICON</h3>
                    <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Hic, incidunt quo consectetur saepe minus eum quidem. Explicabo, dolorum iure voluptate quo repellendus quam quia incidunt natus similique, qui reprehenderit at!
                    </p>
                    <a href="#">View More</a>
                </div>
            </div>
        </div>
    </section>
    <!--End of Upcoming Events-->


    <!--Start of Featured Works-->
    <section class="featured_works">
        <div class="section-wrapper">
            <div class="section-title">
                <h2>featured works</h2>
            </div>
        </div>
        <div class="carousel-slider">
            <div class="container">
                <button class="handle left-handle">
                    <i class="fa-solid fa-angle-left"></i>
                </button>
                <div class="slider">
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>
                    <div>
                        <img src="assets/images/1.jpg" alt="">
                        <a href="#">Book Title<br>Author Name</a>
                    </div>

                </div>
                <button class="handle right-handle">
                    <i class="fa-solid fa-angle-right"></i>
                </button>
            </div>
            <div class="header">
                <div class="progress-bar"></div>
            </div>
        </div>
    </section>
    <!--End of Featured Works-->


    <!--Start of Categories-->
    <section class="categories">
        <div class="section-wrapper">
            <div class="section-title">
                <h2>categories</h2>
            </div>
        </div>
        <div class="carousel-slider">
            <div class="container">
                <button class="handle left-handle">
                    <i class="fa-solid fa-angle-left"></i>
                </button>
                <div class="slider">
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                    <div>
                        <a href="#">
                            <img src="assets/images/1.jpg" alt="">
                            <span>books</span>
                        </a>
                    </div>
                </div>
                <button class="handle right-handle">
                    <i class="fa-solid fa-angle-right"></i>
                </button>
            </div>
            <div class="header">
                <div class="progress-bar"></div>
            </div>
        </div>

    </section>
    <!--End of Categories-->

</body>

<script>
    document.addEventListener("click", e => {
        let handle
        if (e.target.matches(".handle")) {
            handle = e.target
        } else {
            handle = e.target.closest(".handle")
        }
        if (handle != null) onHandleClick(handle)
    })

    const throttleProgressBar = throttle(() => {
        document.querySelectorAll(".progress-bar").forEach(calculateProgressBar)
    }, 250)
    window.addEventListener("resize", throttleProgressBar)

    document.querySelectorAll(".progress-bar").forEach(calculateProgressBar)

    function calculateProgressBar(progressBar) {
        progressBar.innerHTML = ""
        const slider = progressBar.closest(".carousel-slider").querySelector(".slider")
        const itemCount = slider.children.length
        const itemsPerScreen = parseInt(
            getComputedStyle(slider).getPropertyValue("--items-per-screen")
        )
        let sliderIndex = parseInt(
            getComputedStyle(slider).getPropertyValue("--slider-index")
        )
        const progressBarItemCount = Math.ceil(itemCount / itemsPerScreen)

        if (sliderIndex >= progressBarItemCount) {
            slider.style.setProperty("--slider-index", progressBarItemCount - 1)
            sliderIndex = progressBarItemCount - 1
        }

        for (let i = 0; i < progressBarItemCount; i++) {
            const barItem = document.createElement("div")
            barItem.classList.add("progress-item")
            if (i === sliderIndex) {
                barItem.classList.add("active")
            }
            progressBar.append(barItem)
        }
    }

    function onHandleClick(handle) {
        const progressBar = handle.closest(".carousel-slider").querySelector(".progress-bar")
        const slider = handle.closest(".container").querySelector(".slider")
        const sliderIndex = parseInt(
            getComputedStyle(slider).getPropertyValue("--slider-index")
        )
        const progressBarItemCount = progressBar.children.length
        if (handle.classList.contains("left-handle")) {
            if (sliderIndex - 1 < 0) {
                slider.style.setProperty("--slider-index", progressBarItemCount - 1)
                progressBar.children[sliderIndex].classList.remove("active")
                progressBar.children[progressBarItemCount - 1].classList.add("active")
            } else {
                slider.style.setProperty("--slider-index", sliderIndex - 1)
                progressBar.children[sliderIndex].classList.remove("active")
                progressBar.children[sliderIndex - 1].classList.add("active")
            }
        }

        if (handle.classList.contains("right-handle")) {
            if (sliderIndex + 1 >= progressBarItemCount) {
                slider.style.setProperty("--slider-index", 0)
                progressBar.children[sliderIndex].classList.remove("active")
                progressBar.children[0].classList.add("active")
            } else {
                slider.style.setProperty("--slider-index", sliderIndex + 1)
                progressBar.children[sliderIndex].classList.remove("active")
                progressBar.children[sliderIndex + 1].classList.add("active")
            }
        }
    }

    function throttle(cb, delay = 1000) {
        let shouldWait = false
        let waitingArgs
        const timeoutFunc = () => {
            if (waitingArgs == null) {
                shouldWait = false
            } else {
                cb(...waitingArgs)
                waitingArgs = null
                setTimeout(timeoutFunc, delay)
            }
        }

        return (...args) => {
            if (shouldWait) {
                waitingArgs = args
                return
            }

            cb(...args)
            shouldWait = true
            setTimeout(timeoutFunc, delay)
        }
    }
</script>